<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function matches input coordinates (latitude and longitude) to the DOSE dataset.
It accepts either vectors of latitudes and longitudes or a dataframe containing
these coordinates. Before matching, it ensures that only unique coordinates are processed
to avoid duplicating operations on identical coordinates. It downloads the GADM-1 geometries
from a specified URL if not already cached locally, unzips it, and returns a dataframe with
unique input coordinates and matched DOSE data. Optionally, the function can filter the DOSE dataset by specific years.
Additionally, users can specify countries directly to skip the country matching step, potentially saving processing time."><title>Match coordinates to DOSE dataset — matchDOSE • subincomeR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match coordinates to DOSE dataset — matchDOSE"><meta property="og:description" content="This function matches input coordinates (latitude and longitude) to the DOSE dataset.
It accepts either vectors of latitudes and longitudes or a dataframe containing
these coordinates. Before matching, it ensures that only unique coordinates are processed
to avoid duplicating operations on identical coordinates. It downloads the GADM-1 geometries
from a specified URL if not already cached locally, unzips it, and returns a dataframe with
unique input coordinates and matched DOSE data. Optionally, the function can filter the DOSE dataset by specific years.
Additionally, users can specify countries directly to skip the country matching step, potentially saving processing time."><meta property="og:image" content="https://pablogguz.github.io/subincomeR/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@pablogguz_"><meta name="twitter:site" content="@pablogguz_"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">subincomeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Match coordinates to DOSE dataset</h1>
      
      <div class="d-none name"><code>matchDOSE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function matches input coordinates (latitude and longitude) to the DOSE dataset.
It accepts either vectors of latitudes and longitudes or a dataframe containing
these coordinates. Before matching, it ensures that only unique coordinates are processed
to avoid duplicating operations on identical coordinates. It downloads the GADM-1 geometries
from a specified URL if not already cached locally, unzips it, and returns a dataframe with
unique input coordinates and matched DOSE data. Optionally, the function can filter the DOSE dataset by specific years.
Additionally, users can specify countries directly to skip the country matching step, potentially saving processing time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">matchDOSE</span><span class="op">(</span></span>
<span>  lat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  long <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lat_col <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  long_col <span class="op">=</span> <span class="st">"long"</span>,</span>
<span>  years <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  countries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format_countries <span class="op">=</span> <span class="st">"iso3c"</span>,</span>
<span>  gpkg_path <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>lat</dt>
<dd><p>Optional vector of latitudes of the points to match. Required if no dataframe is provided.</p></dd>


<dt>long</dt>
<dd><p>Optional vector of longitudes of the points to match. Required if no dataframe is provided.</p></dd>


<dt>df</dt>
<dd><p>Optional dataframe containing coordinates and possibly additional columns. If provided,
'lat' and 'long' vectors should not be provided. The dataframe must include columns specified
by 'lat_col' and 'long_col' parameters.</p></dd>


<dt>lat_col</dt>
<dd><p>Optional name of the latitude column in 'df'. Only used if 'df' is provided.
Defaults to "lat".</p></dd>


<dt>long_col</dt>
<dd><p>Optional name of the longitude column in 'df'. Only used if 'df' is provided.
Defaults to "long".</p></dd>


<dt>years</dt>
<dd><p>Optional vector of years for which to filter the DOSE dataset.
If NULL (the default), a 1:m matching is performed and data for all years are returned.</p></dd>


<dt>countries</dt>
<dd><p>Optional vector or dataframe column name of country identifiers.
If provided, the function skips the country matching step. The identifiers can be in the format specified
by 'format_countries'. This can significantly reduce processing time.</p></dd>


<dt>format_countries</dt>
<dd><p>Specifies the format of the country identifiers in 'countries'.
Options are "country.name" (default), "iso3c", and "iso2c". This parameter is ignored if 'countries' is NULL.</p></dd>


<dt>gpkg_path</dt>
<dd><p>Optional path to store the .gpkg file. If not specified, the default cache directory is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A dataframe with input coordinates (and any additional input dataframe columns) and matched DOSE data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Match two pairs of coordinates to DOSE using vectors</span></span></span>
<span class="r-in"><span><span class="va">matched_data_vectors</span> <span class="op">&lt;-</span> <span class="fu">matchDOSE</span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19.4326</span>, <span class="fl">51.5074</span><span class="op">)</span>, long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99.1332</span>, <span class="op">-</span><span class="fl">0.1276</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Geometries not found in machine. Downloading GADM-DOSE geometries...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> GADM-DOSE successfully downloaded and stored in ~/.cache/subincomeR</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Passing 2 coordinates to the Nominatim single coordinate geocoder</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query completed in: 2 seconds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matching coordinates to subdivisions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading DOSE dataset...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match two pairs of coordinates to DOSE using a dataframe</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19.4326</span>, <span class="fl">51.5074</span><span class="op">)</span>, longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99.1332</span>, <span class="op">-</span><span class="fl">0.1276</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">matched_data_df</span> <span class="op">&lt;-</span> <span class="fu">matchDOSE</span><span class="op">(</span>df <span class="op">=</span> <span class="va">df</span>, lat_col <span class="op">=</span> <span class="st">"latitude"</span>, long_col <span class="op">=</span> <span class="st">"longitude"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Passing 2 coordinates to the Nominatim single coordinate geocoder</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query completed in: 2 seconds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matching coordinates to subdivisions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading DOSE dataset...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match coordinates to DOSE for a specific year using vectors</span></span></span>
<span class="r-in"><span><span class="va">matched_data_2019</span> <span class="op">&lt;-</span> <span class="fu">matchDOSE</span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19.4326</span><span class="op">)</span>, long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99.1332</span><span class="op">)</span>, years <span class="op">=</span> <span class="fl">2019</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Passing 1 coordinate to the Nominatim single coordinate geocoder</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Query completed in: 1 seconds</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matching coordinates to subdivisions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading DOSE dataset...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering years...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Match coordinates and specify countries to skip country matching</span></span></span>
<span class="r-in"><span><span class="va">matched_data_with_countries</span> <span class="op">&lt;-</span> <span class="fu">matchDOSE</span><span class="op">(</span>lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19.4326</span>, <span class="fl">51.5074</span><span class="op">)</span>, long <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">99.1332</span>, <span class="op">-</span><span class="fl">0.1276</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                         countries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MEX"</span>, <span class="st">"GBR"</span><span class="op">)</span>, format_countries <span class="op">=</span> <span class="st">"iso3c"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Country identifiers are provided. Skipping geocoding...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Matching coordinates to subdivisions...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading DOSE dataset...</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pablo Garcia-Guzman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

